# æœ¬åœ°å¼€å‘è¿æ¥æœåŠ¡å™¨æ•°æ®åº“è¯´æ˜

## ğŸ“ æ­£ç¡®çš„æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ°å¼€å‘ç¯å¢ƒ (macOS)                                      â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  å‰ç«¯æœåŠ¡        â”‚      â”‚   åç«¯æœåŠ¡        â”‚          â”‚
â”‚  â”‚  localhost:5173 â”‚      â”‚  localhost:8080  â”‚          â”‚
â”‚  â”‚  (Vue 3)        â”‚â”€â”€â”€â”€â”€â–¶â”‚  (Spring Boot)   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                    â”‚                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ ç½‘ç»œè¿æ¥
                                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡å™¨ (58.87.103.99)                                    â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Docker å®¹å™¨                              â”‚           â”‚
â”‚  â”‚                                           â”‚           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚           â”‚
â”‚  â”‚  â”‚  MySQL     â”‚    â”‚   Redis      â”‚     â”‚           â”‚
â”‚  â”‚  â”‚  :3306     â”‚    â”‚   :6379      â”‚     â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚           â”‚
â”‚  â”‚                                           â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. åç«¯é…ç½®å·²ä¿®æ”¹

æ–‡ä»¶ï¼š`datahub-backend/src/main/resources/application.yml`

```yaml
spring:
  # æ•°æ®æºé…ç½®ï¼ˆè¿æ¥æœåŠ¡å™¨ä¸Šçš„MySQLï¼‰
  datasource:
    druid:
      url: jdbc:mysql://58.87.103.99:3306/datahub?...
      username: root
      password: DataHub@2025
  
  # Redisé…ç½®ï¼ˆè¿æ¥æœåŠ¡å™¨ä¸Šçš„Redisï¼‰
  redis:
    host: 58.87.103.99
    port: 6379
    password: DataHub@2025
```

### 2. æœåŠ¡å™¨æ•°æ®åº“ä¿¡æ¯

- **MySQLåœ°å€**: 58.87.103.99:3306
- **æ•°æ®åº“å**: datahub
- **ç”¨æˆ·å**: root
- **å¯†ç **: DataHub@2025

- **Redisåœ°å€**: 58.87.103.99:6379
- **å¯†ç **: DataHub@2025

## ğŸš€ å¯åŠ¨æ­¥éª¤

### 1. ç¡®ä¿æœåŠ¡å™¨æ•°æ®åº“å·²å¯åŠ¨

```bash
# SSHç™»å½•åˆ°æ•°æ®åº“æœåŠ¡å™¨
ssh datahub-db

# æ£€æŸ¥Dockerå®¹å™¨çŠ¶æ€
docker ps

# åº”è¯¥çœ‹åˆ°ä»¥ä¸‹å®¹å™¨æ­£åœ¨è¿è¡Œï¼š
# - datahub-mysql
# - datahub-redis
# - datahub-postgresql
# - datahub-zookeeper
```

### 2. å¯åŠ¨æœ¬åœ°åç«¯æœåŠ¡

```bash
# æ‰“å¼€æ–°ç»ˆç«¯
cd /Users/liumingze/DataHub/datahub-backend

# è®¾ç½®Javaç¯å¢ƒ
export JAVA_HOME=$(/usr/libexec/java_home)

# å¯åŠ¨åç«¯æœåŠ¡
mvn spring-boot:run
```

### 3. å‰ç«¯å·²åœ¨è¿è¡Œ

å‰ç«¯å·²ç»åœ¨è¿è¡Œï¼ˆlocalhost:5173ï¼‰ï¼Œæ— éœ€é‡å¯ã€‚

### 4. æµ‹è¯•ç™»å½•

è®¿é—®ï¼šhttp://localhost:5173

- ç”¨æˆ·åï¼š`admin`
- å¯†ç ï¼š`admin123`

## ğŸ” éªŒè¯è¿æ¥

### æµ‹è¯•MySQLè¿æ¥

```bash
# ä»æœ¬åœ°è¿æ¥åˆ°æœåŠ¡å™¨MySQL
mysql -h 58.87.103.99 -P 3306 -u root -pDataHub@2025 -e "USE datahub; SHOW TABLES;"
```

åº”è¯¥çœ‹åˆ°7å¼ è¡¨ï¼š
- sys_user
- datasource
- sync_task
- query_history
- dataset
- report
- dashboard_stats

### æµ‹è¯•Redisè¿æ¥

```bash
# ä»æœ¬åœ°è¿æ¥åˆ°æœåŠ¡å™¨Redis
redis-cli -h 58.87.103.99 -p 6379 -a DataHub@2025 ping
```

åº”è¯¥è¿”å›ï¼š`PONG`

## ğŸ“Š æ•°æ®æµç¨‹

1. **ç”¨æˆ·åœ¨æµè§ˆå™¨è®¿é—®å‰ç«¯** (localhost:5173)
2. **å‰ç«¯è°ƒç”¨æœ¬åœ°åç«¯API** (localhost:8080/api)
3. **åç«¯è¿æ¥æœåŠ¡å™¨æ•°æ®åº“** (58.87.103.99:3306)
4. **è¿”å›æ•°æ®ç»™å‰ç«¯æ˜¾ç¤º**

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šæ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨æ•°æ®åº“

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Communications link failure
```

**å¯èƒ½åŸå› **ï¼š
1. æœåŠ¡å™¨é˜²ç«å¢™æœªå¼€æ”¾3306ç«¯å£
2. Dockerå®¹å™¨æœªå¯åŠ¨
3. ç½‘ç»œä¸é€š

**è§£å†³æ–¹æ³•**ï¼š
```bash
# 1. æ£€æŸ¥æœåŠ¡å™¨é˜²ç«å¢™
ssh datahub-db
firewall-cmd --list-ports

# åº”è¯¥åŒ…å«ï¼š3306/tcp 6379/tcp

# 2. æ£€æŸ¥Dockerå®¹å™¨
docker ps | grep datahub-mysql

# 3. æµ‹è¯•ç½‘ç»œè¿é€šæ€§
telnet 58.87.103.99 3306
```

### é—®é¢˜2ï¼šè®¤è¯å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š
```
Access denied for user 'root'@'xxx'
```

**è§£å†³æ–¹æ³•**ï¼š
æ£€æŸ¥å¯†ç æ˜¯å¦æ­£ç¡®ï¼š`DataHub@2025`

### é—®é¢˜3ï¼šJAVA_HOMEé”™è¯¯

**é”™è¯¯ä¿¡æ¯**ï¼š
```
The JAVA_HOME environment variable is not defined correctly
```

**è§£å†³æ–¹æ³•**ï¼š
```bash
export JAVA_HOME=$(/usr/libexec/java_home)
echo $JAVA_HOME
```

## ğŸ’¡ ä¼˜åŠ¿

è¿™ç§æ¶æ„çš„ä¼˜åŠ¿ï¼š

1. **æœ¬åœ°å¼€å‘ï¼ŒæœåŠ¡å™¨æ•°æ®**
   - å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒæ•°æ®ä¸€è‡´
   - æ— éœ€åœ¨æœ¬åœ°å®‰è£…MySQLå’ŒRedis

2. **å¿«é€Ÿè¿­ä»£**
   - å‰åç«¯ä»£ç åœ¨æœ¬åœ°ä¿®æ”¹
   - å®æ—¶çœ‹åˆ°æ•ˆæœ
   - æ— éœ€æ¯æ¬¡éƒ½éƒ¨ç½²åˆ°æœåŠ¡å™¨

3. **å›¢é˜Ÿåä½œ**
   - å¤šäººå¯ä»¥å…±äº«åŒä¸€ä¸ªæ•°æ®åº“
   - æ•°æ®åŒæ­¥ï¼Œé¿å…æœ¬åœ°æ•°æ®ä¸ä¸€è‡´

## ğŸ¯ ä¸‹ä¸€æ­¥

1. âœ… åç«¯å·²é…ç½®è¿æ¥æœåŠ¡å™¨æ•°æ®åº“
2. âœ… åç«¯æ­£åœ¨å¯åŠ¨ä¸­
3. â³ ç­‰å¾…åç«¯å¯åŠ¨å®Œæˆï¼ˆçº¦30-60ç§’ï¼‰
4. â³ æµ‹è¯•ç™»å½•åŠŸèƒ½

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **ç¡®ä¿æœåŠ¡å™¨æ•°æ®åº“å·²åˆå§‹åŒ–**
   - æ•°æ®åº“å·²åˆ›å»º
   - è¡¨å·²åˆ›å»º
   - é»˜è®¤ç”¨æˆ·å·²æ’å…¥

2. **ç½‘ç»œç¨³å®šæ€§**
   - æœ¬åœ°åˆ°æœåŠ¡å™¨çš„ç½‘ç»œå»¶è¿Ÿä¼šå½±å“å“åº”é€Ÿåº¦
   - å»ºè®®åœ¨ç½‘ç»œç¨³å®šçš„ç¯å¢ƒä¸‹å¼€å‘

3. **å®‰å…¨æ€§**
   - æœåŠ¡å™¨å·²å¼€æ”¾3306å’Œ6379ç«¯å£
   - å»ºè®®åªå…è®¸ç‰¹å®šIPè®¿é—®
   - ç”Ÿäº§ç¯å¢ƒåº”è¯¥ä½¿ç”¨æ›´å¼ºçš„å¯†ç 

## ğŸ” æœåŠ¡å™¨å®‰å…¨é…ç½®

å¦‚æœéœ€è¦é™åˆ¶è®¿é—®ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šé…ç½®é˜²ç«å¢™ï¼š

```bash
# åªå…è®¸ä½ çš„IPè®¿é—®MySQL
firewall-cmd --permanent --add-rich-rule='rule family="ipv4" source address="ä½ çš„IP" port protocol="tcp" port="3306" accept'
firewall-cmd --reload
```

